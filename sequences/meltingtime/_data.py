#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"melting time data"
from   typing import Dict
import numpy  as np

NNDATA = Dict[str, np.ndarray]

# RNA/DNA
# Sugimoto et al. (1995), Biochemistry 34: 11211-11216
RNA_DNA_NN1 = {
    'init': (1.9, -3.9), 'init_A/T': (0, 0), 'init_G/C': (0, 0),
    'init_oneG/C': (0, 0), 'init_allA/T': (0, 0), 'init_5T/A': (0, 0),
    'sym': (0, 0),
    'AA/TT': (-11.5, -36.4), 'AC/TG': (-7.8, -21.6), 'AG/TC': (-7.0, -19.7),
    'AT/TA': (-8.3, -23.9), 'CA/GT': (-10.4, -28.4), 'CC/GG': (-12.8, -31.9),
    'CG/GC': (-16.3, -47.1), 'CT/GA': (-9.1, -23.5), 'GA/CT': (-8.6, -22.9),
    'GC/CG': (-8.0, -17.1), 'GG/CC': (-9.3, -23.2), 'GT/CA': (-5.9, -12.3),
    'TA/AT': (-7.8, -23.2), 'TC/AG': (-5.5, -13.5), 'TG/AC': (-9.0, -26.1),
    'TT/AA': (-7.8, -21.9)
}

# LNA/DNA
# Owczarzy R, You Y, Groth CL, and Tataurov AV (2011) Stability and mismatch
# discrimination of locked nucleic acid-DNA duplexes. Biochemistry,
# 50:9352-9367.
LNA_DNA_NN5 = {
    'init': (0, 0),
    'init_A/T': (2.3, 4.1),
    'init_G/C': (0.1, -2.8),
    'init_oneG/C': (0, 0),
    'init_allA/T': (0, 0),
    'init_5T/A': (0, 0),
    'sym': (0, -1.4),
    'AA/TT':(-9.991,-27.175),
    'AC/TG':(-11.389,-28.963),
    'AG/TC':(-12.793,-31.607),
    'AT/TA':(-14.703,-40.750),
    'CA/GT':(-14.177,-35.498),
    'CC/GG':(-15.399,-36.375),
    'CG/GC':(-14.558,-35.239),
    'CT/GA':(-15.737,-41.218),
    'GA/CT':(-13.959,-35.097),
    'GC/CG':(-16.109,-40.738),
    'GG/CC':(-13.022,-29.673),
    'GT/CA':(-17.361,-45.858),
    'TA/AT':(-10.318,-26.108),
    'TC/AG':(-9.166,-21.535),
    'TG/AC':(-10.046,-22.591),
    'TT/AA':(-10.419,-27.683)
}

LNA_DNA_NN1 = {
    'init': (0, 0), 'init_A/T': (2.3, 4.1), 'init_G/C': (0.1, -2.8),
    'init_oneG/C': (0, 0), 'init_allA/T': (0, 0), 'init_5T/A': (0, 0),
    'sym': (0, -1.4),

    #'aa/tt':(-7.9,-22.25),'ac/tg':(-8.4,-22.45),'ag/tc':(-7.8,-21.025),'at/ta':(-7.2,-20.375),
    #'ca/gt':(-8.5,-22.725),'cc/gg':(-8.0,-19.85),'cg/gc':(-10.6,-27.2),'ct/ga':(-7.8,-21.025),
    #'ga/ct':(-8.2,-22.25),'gc/cg':(-9.8,-24.375),'gg/cc':(-8.0,-19.85),'gt/ca':(-8.4,-22.45),
    #'ta/at':(-7.2,-21.35),'tc/ag':(-8.2,-22.25),'tg/ac':(-8.5,-22.725),'tt/aa':(-7.9,-22.25),

    'aa/tt':(-7.9,-22.2),'ac/tg':(-8.4,-22.4),'ag/tc':(-7.8,-21.0),'at/ta':(-7.2,-20.4),
    'ca/gt':(-8.5,-22.7),'cc/gg':(-8.0,-19.9),'cg/gc':(-10.6,-27.2),'ct/ga':(-7.8,-21.0),
    'ga/ct':(-8.2,-22.2),'gc/cg':(-9.8,-24.4),'gg/cc':(-8.0,-19.9),'gt/ca':(-8.4,-22.4),
    'ta/at':(-7.2,-21.3),'tc/ag':(-8.2,-22.2),'tg/ac':(-8.5,-22.7),'tt/aa':(-7.9,-22.2),

    'AA/tt':(-9.991,-27.175),
    'AC/tg':(-11.389,-28.963),
    'AG/tc':(-12.793,-31.607),
    'AT/ta':(-14.703,-40.750),
    'CA/gt':(-14.177,-35.498),
    'CC/gg':(-15.399,-36.375),
    'CG/gc':(-14.558,-35.239),
    'CT/ga':(-15.737,-41.218),
    'GA/ct':(-13.959,-35.097),
    'GC/cg':(-16.109,-40.738),
    'GG/cc':(-13.022,-29.673),
    'GT/ca':(-17.361,-45.858),
    'TA/at':(-10.318,-26.108),
    'TC/ag':(-9.166,-21.535),
    'TG/ac':(-10.046,-22.591),
    'TT/aa':(-10.419,-27.683),


    'Aa/tt':(-7.193,-19.723),
    'Ac/tg':(-7.269,-18.336),
    'Ag/tc':(-7.536,-18.387),
    'At/ta':(-4.918,-12.943),
    'Ca/gt':(-7.451,-18.380),
    'Cc/gg':(-5.904,-11.904),
    'Cg/gc':(-9.815,-23.491),
    'Ct/ga':(-7.092,-16.825),
    'Ga/ct':(-5.038,11.656),
    'Gc/cg':(-10.160,-24.651),
    'Gg/cc':(-10.844,-26.580),
    'Gt/ca':(-8.612,-22.327),
    'Ta/at':(-7.246,-19.738),
    'Tc/ag':(-6.307,-15.515),
    'Tg/ac':(-10.040,-25.744),
    'Tt/aa':(-6.372,-16.902),

    'aA/tt':(-6.908,-18.135),
    'aC/tg':(-5.510,-11.824),
    'aG/tc':(-9.000,-22.826),
    'aT/ta':(-5.384,-13.537),
    'cA/gt':(-7.142,-18.333),
    'cC/gg':(-5.937,-12.335),
    'cG/gc':(-10.876,-27.918),
    'cT/ga':(-9.471,-25.070),
    'gA/ct':(-7.756,-19.302),
    'gC/cg':(-10.725,-25.511),
    'gG/cc':(-8.943,-20.833),
    'gT/ca':(-9.035,-22.742),
    'tA/at':(-5.609,-16.019),
    'tC/ag':(-7.591,-19.031),
    'tG/ac':(-6.335,-15.537),
    'tT/aa':(-5.574,-14.149)
}

LNA_DNA_NN2 = {
    'init': (0, 0), 'init_A/T': (2.3, 4.1), 'init_G/C': (0.1, -2.8),
    'init_oneG/C': (0, 0), 'init_allA/T': (0, 0), 'init_5T/A': (0, 0),
    'sym': (0, -1.4),

    'aa/tt':(-7.9,-22.2),
    'ac/tg':(-8.4,-22.4),
    'ag/tc':(-7.8,-21.0),
    'at/ta':(-7.2,-20.4),
    'ca/gt':(-8.5,-22.7),
    'cc/gg':(-8.0,-19.9),
    'cg/gc':(-10.6,-27.2),
    'ct/ga':(-7.8,-21.0),
    'ga/ct':(-8.2,-22.2),
    'gc/cg':(-9.8,-24.4),
    'gg/cc':(-8.0,-19.9),
    'gt/ca':(-8.4,-22.4),
    'ta/at':(-7.2,-21.3),
    'tc/ag':(-8.2,-22.2),
    'tg/ac':(-8.5,-22.7),
    'tt/aa':(-7.9,-22.2),

    'AA/tt':(-9.991,-27.175),
    'AC/tg':(-11.389,-28.963),
    'AG/tc':(-12.793,-31.607),
    'AT/ta':(-14.703,-40.750),
    'CA/gt':(-14.177,-35.498),
    'CC/gg':(-15.399,-36.375),
    'CG/gc':(-14.558,-35.239),
    'CT/ga':(-15.737,-41.218),
    'GA/ct':(-13.959,-35.097),
    'GC/cg':(-16.109,-40.738),
    'GG/cc':(-13.022,-29.673),
    'GT/ca':(-17.361,-45.858),
    'TA/at':(-10.318,-26.108),
    'TC/ag':(-9.166,-21.535),
    'TG/ac':(-10.046,-22.591),
    'TT/aa':(-10.419,-27.683),

    'Aa/tt':(-6.726,-18.443),
    'Ac/tg':(-7.052,-17.790),
    'Ag/tc':(-7.738,-18.880),
    'At/ta':(-6.729,-17.710),
    'Ca/gt':(-7.312,-18.038),
    'Cc/gg':(-6.269,-12.641),
    'Cg/gc':(-10.409,-24.913),
    'Ct/ga':(-7.901,-18.745),
    'Ga/ct':(-5.471,-12.659),
    'Gc/cg':(-9.272,-22.497),
    'Gg/cc':(-9.580,-23.482),
    'Gt/ca':(-8.898,-23.069),
    'Ta/at':(-6.338,-17.265),
    'Tc/ag':(-6.795,-16.714),
    'Tg/ac':(-8.671,-22.235),
    'Tt/aa':(-7.610,-20.185),

    'aA/tt':(-7.379,-19.371),
    'aC/tg':(-6.589,-14.140),
    'aG/tc':(-7.598,-19.269),
    'aT/ta':(-5.543,-13.937),
    'cA/gt':(-7.913,-20.313),
    'cC/gg':(-6.533,-13.573),
    'cG/gc':(-10.151,-26.058),
    'cT/ga':(-9.026,-23.892),
    'gA/ct':(-7.527,-18.731),
    'gC/cg':(-9.185,-21.849),
    'gG/cc':(-8.989,-20.941),
    'gT/ca':(-8.846,-22.267),
    'tA/at':(-8.338,-23.812),
    'tC/ag':(-9.597,-24.060),
    'tG/ac':(-7.189,-17.633),
    'tT/aa':(-7.123,-18.081 )
}

# LNA/DNA
# Owczarzy R, You Y, Groth CL, and Tataurov AV (2011) Stability and mismatch
# discrimination of locked nucleic acid-DNA duplexes. Biochemistry,
# 50:9352-9367.
LNA_DNA_IMM1 = {
    'AA/at': (-3.826, -13.109),
    'AC/ag': (-2.367, -7.322),
    'AG/ac': (-4.849, -13.007),
    'AT/aa': (-5.049, -17.514),
    'AA/ta': (-4.229, -15.160),
    'CA/ga': (-5.878, -17.663),
    'GA/ca': (-8.558, -23.976),
    'TA/aa': (2.074, 3.446),
    'CA/ct': (2.218, 4.750),
    'CC/cg': (1.127, 1.826),
    'CG/cc': (-10.903, -32.025),
    'CT/ca': (-2.053, -10.517),
    'AC/tc': (1.065, -1.403),
    'CC/gc': (-9.522, -27.024),
    'GC/cc': (-4.767, -14.897),
    'TC/ac': (4.114, 9.258),
    'GA/gt': (-2.920, -9.387),
    'GC/gg': (-8.139, -21.784),
    'GG/gc': (-5.149, -12.508),
    'GT/ga': (-8.991, -27.311),
    'AG/tg': (-4.980, -15.426),
    'CG/gg': (-4.441, -12.158),
    'GG/cg': (-13.505, -36.021),
    'TG/ag': (-2.775, -9.286),
    'TA/tt': (-3.744, -12.149),
    'TC/tg': (-4.387, -13.520),
    'TG/tc': (-6.346, -16.629),
    'TT/ta': (-7.697, -25.049),
    'AT/tt': (-4.207, -14.307),
    'CT/gt': (-8.176, -22.962),
    'GT/ct': (-7.241, -20.622),
    'TT/at': (-2.051, -7.055),
    'AA/ct': (-1.362, -5.551),
    'AC/cg': (-1.759, -6.511),
    'AG/cc': (-6.549, -18.073),
    'AT/ca': (-3.563, -14.105),
    'AA/tc': (-2.078, -10.088),
    'CA/gc': (-5.868, -16.952),
    'GA/cc': (-8.477, -24.565),
    'TA/ac': (2.690, 4.965),
    'CA/at': (-9.844, -29.673),
    'CC/ag': (-3.761, -11.204),
    'CG/ac': (-9.845, -27.316),
    'CT/aa': (-3.389, -12.517),
    'AC/ta': (0.753, -0.503),
    'CC/ga': (-12.714, -35.555),
    'GC/ca': (-12.658, -35.729),
    'TC/aa': (-1.719, -7.023),
    'AA/gt': (2.193, 4.374),
    'AC/gg': (-8.453, -22.672),
    'AG/gc': (-1.164, -2.532),
    'AT/ga': (-7.418, -24.066),
    'AA/tg': (-1.963, -9.013),
    'CA/gg': (-8.712, -23.779),
    'GA/cg': (-7.875, -21.661),
    'TA/ag': (3.207, 7.156),
    'GA/at': (-2.914, -9.402),
    'GC/ag': (-9.131, -25.347),
    'GG/ac': (-2.154, -3.871),
    'GT/aa': (-8.515, -26.313),
    'AG/ta': (-6.691, -21.148),
    'CG/ga': (-3.960, -10.588),
    'GG/ca': (-12.898, -34.656),
    'TG/aa': (0.334, -0.440),
    'CA/tt': (0.382, -0.579),
    'CC/tg': (-2.716, -8.000),
    'CG/tc': (-10.363, -29.315),
    'CT/ta': (-5.783, -20.173),
    'AC/tt': (-0.692, -5.278),
    'CC/gt': (-10.299, -28.503),
    'GC/ct': (-9.062, -26.356),
    'TC/at': (2.073, 3.968),
    'TA/ct': (-5.485, -17.347),
    'TC/cg': (1.451, 1.556),
    'TG/cc': (-7.213, -20.128),
    'TT/ca': (-2.397, -11.371),
    'AT/tc': (-0.633, -5.801),
    'CT/gc': (-6.868, -21.000),
    'GT/cc': (-5.853, -16.643),
    'TT/ac': (0.211, -1.446),
    'GA/tt': (-5.551, -15.398),
    'GC/tg': (-14.943, -40.148),
    'GG/tc': (-8.110, -18.349),
    'GT/ta': (-14.213, -40.041),
    'AG/tt': (-7.130, -20.786),
    'CG/gt': (-14.862, -39.430),
    'GG/ct': (-14.622, -37.510),
    'TG/at': (-6.703, -18.111),
    'TA/gt': (-4.612, -14.039),
    'TC/gg': (-9.798, -26.406),
    'TG/gc': (-4.519, -11.065),
    'TT/ga': (-4.523, -15.693),
    'AT/tg': (-2.364, -8.834),
    'CT/gg': (-11.396, -30.732),
    'GT/cg': (-6.233, -15.933),
    'TT/ag': (-2.960, -9.305)
}

# copy of DNA terminal mismatches partially corrected...
LNA_DNA_TMM1 = {
    'aa/TA': (-3.1, -7.8), 'ta/AA': (-2.5, -6.3), 'ca/GA': (-4.3, -10.7),
    'ga/CA': (-4.66, -11.43),
    'ac/TC': (-0.1, 0.5), 'tc/AC': (2.1, 4.76), 'cc/GC': (-2.1, -5.1),
    'gc/CC': (-9.62, -24.2),
    'ag/TG': (-1.1, -2.1), 'tg/AG': (-1.1, -2.7), 'cg/GG': (-3.8, -9.5),
    'gg/CG': (-8.24, -21.54),
    'at/TT': (-2.4, -6.5), 'tt/AT': (-3.2, -8.9), 'ct/GT': (-6.1, -16.9),
    'gt/CT': (-7.4, -21.2),
    'aa/TC': (-1.6, -4.0), 'ac/TA': (-1.8, -3.8), 'ca/GC': (-2.6, -5.9),
    'cc/GA': (-2.7, -6.0), 'ga/CC': (-12.8, -32.75), 'gc/CA': (-4.062, -10.62),
    'ta/AC': (-10, -30.7), 'tc/AA': (-2.7, -7.0),
    'ac/TT': (-0.9, -1.7), 'at/TC': (-2.3, -6.3), 'cc/GT': (-3.2, -8.0),
    'ct/GC': (-3.9, -10.6), 'gc/CT': (-4.9, -13.5), 'gt/CC': (-10.4, -25.7),
    'tc/AT': (-2.5, -6.3), 'tt/AC': (0.28, -1.02),
    'aa/TG': (-1.9, -4.4), 'ag/TA': (-2.5, -5.9), 'ca/GG': (-3.9, -9.6),
    'cg/GA': (-6.0, -15.5), 'ga/CG': (-9.24, -25.57), 'gg/CA': (-10.75, -26.8),
    'ta/AG': (-2.0, -4.7), 'tg/AA': (-2.4, -5.8),
    'ag/TT': (-3.2, -8.7), 'at/TG': (-3.5, -9.4), 'cg/GT': (-3.8, -9.0),
    'ct/GG': (-6.6, -18.7), 'gg/CT': (-5.7, -15.9), 'gt/CG': (-15.05, -40.65),
    'tg/AT': (-3.9, -10.5), 'tt/AG': (-3.6, -9.8)
}

# Thermodynamic lookup tables (dictionaries):
# Enthalpy (dH) and entropy (dS) values for nearest neighbors and initiation
# process. Calculation of duplex initiation is quite different in several
# papers; to allow for a general calculation, all different initiation
# parameters are included in all tables and non-applicable parameters are set
# to zero.
# The key is either an initiation type (e.g., 'init_A/T') or a nearest neighbor
# duplex sequence (e.g., GT/CA, to read 5'GT3'-3'CA5'). The values are tuples
# of dH (kcal/mol), dS (cal/mol K).

# DNA/DNA
# Breslauer et al. (1986), Proc Natl Acad Sci USA 83: 3746-3750
DNA_NN1 = {
    'init': (0, 0), 'init_A/T': (0, 0), 'init_G/C': (0, 0),
    'init_oneG/C': (0, -16.8), 'init_allA/T': (0, -20.1), 'init_5T/A': (0, 0),
    'sym': (0, -1.3),
    'AA/TT': (-9.1, -24.0), 'AT/TA': (-8.6, -23.9), 'TA/AT': (-6.0, -16.9),
    'CA/GT': (-5.8, -12.9), 'GT/CA': (-6.5, -17.3), 'CT/GA': (-7.8, -20.8),
    'GA/CT': (-5.6, -13.5), 'CG/GC': (-11.9, -27.8), 'GC/CG': (-11.1, -26.7),
    'GG/CC': (-11.0, -26.6)}

# Sugimoto et al. (1996), Nuc Acids Res 24 : 4501-4505
DNA_NN2 = {
    'init': (0.6, -9.0), 'init_A/T': (0, 0), 'init_G/C': (0, 0),
    'init_oneG/C': (0, 0), 'init_allA/T': (0, 0), 'init_5T/A': (0, 0),
    'sym': (0, -1.4),
    'AA/TT': (-8.0, -21.9), 'AT/TA': (-5.6, -15.2), 'TA/AT': (-6.6, -18.4),
    'CA/GT': (-8.2, -21.0), 'GT/CA': (-9.4, -25.5), 'CT/GA': (-6.6, -16.4),
    'GA/CT': (-8.8, -23.5), 'CG/GC': (-11.8, -29.0), 'GC/CG': (-10.5, -26.4),
    'GG/CC': (-10.9, -28.4)}

# Allawi and SantaLucia (1997), Biochemistry 36: 10581-10594
DNA_NN3 = {
    'init': (0, 0), 'init_A/T': (2.3, 4.1), 'init_G/C': (0.1, -2.8),
    'init_oneG/C': (0, 0), 'init_allA/T': (0, 0), 'init_5T/A': (0, 0),
    'sym': (0, -1.4),
    'AA/TT': (-7.9, -22.2), 'AT/TA': (-7.2, -20.4), 'TA/AT': (-7.2, -21.3),
    'CA/GT': (-8.5, -22.7), 'GT/CA': (-8.4, -22.4), 'CT/GA': (-7.8, -21.0),
    'GA/CT': (-8.2, -22.2), 'CG/GC': (-10.6, -27.2), 'GC/CG': (-9.8, -24.4),
    'GG/CC': (-8.0, -19.9)}

# SantaLucia & Hicks (2004), Annu. Rev. Biophys. Biomol. Struct 33: 415-440
DNA_NN4 = {
    'init': (0.2, -5.7), 'init_A/T': (2.2, 6.9), 'init_G/C': (0, 0),
    'init_oneG/C': (0, 0), 'init_allA/T': (0, 0), 'init_5T/A': (0, 0),
    'sym': (0, -1.4),
    'AA/TT': (-7.6, -21.3), 'AT/TA': (-7.2, -20.4), 'TA/AT': (-7.2, -20.4),
    'CA/GT': (-8.5, -22.7), 'GT/CA': (-8.4, -22.4), 'CT/GA': (-7.8, -21.0),
    'GA/CT': (-8.2, -22.2), 'CG/GC': (-10.6, -27.2), 'GC/CG': (-9.8, -24.4),
    'GG/CC': (-8.0, -19.0)}

# RNA/RNA
# Freier et al. (1986), Proc Natl Acad Sci USA 83: 9373-9377
RNA_NN1 = {
    'init': (0, -10.8), 'init_A/T': (0, 0), 'init_G/C': (0, 0),
    'init_oneG/C': (0, 0), 'init_allA/T': (0, 0), 'init_5T/A': (0, 0),
    'sym': (0, -1.4),
    'AA/TT': (-6.6, -18.4), 'AT/TA': (-5.7, -15.5), 'TA/AT': (-8.1, -22.6),
    'CA/GT': (-10.5, -27.8), 'GT/CA': (-10.2, -26.2), 'CT/GA': (-7.6, -19.2),
    'GA/CT': (-13.3, -35.5), 'CG/GC': (-8.0, -19.4), 'GC/CG': (-14.2, -34.9),
    'GG/CC': (-12.2, -29.7)}

# Xia et al (1998), Biochemistry 37: 14719-14735
RNA_NN2 = {
    'init': (3.61, -1.5), 'init_A/T': (3.72, 10.5), 'init_G/C': (0, 0),
    'init_oneG/C': (0, 0), 'init_allA/T': (0, 0), 'init_5T/A': (0, 0),
    'sym': (0, -1.4),
    'AA/TT': (-6.82, -19.0), 'AT/TA': (-9.38, -26.7), 'TA/AT': (-7.69, -20.5),
    'CA/GT': (-10.44, -26.9), 'GT/CA': (-11.40, -29.5),
    'CT/GA': (-10.48, -27.1), 'GA/CT': (-12.44, -32.5),
    'CG/GC': (-10.64, -26.7), 'GC/CG': (-14.88, -36.9),
    'GG/CC': (-13.39, -32.7)}

# Chen et al. (2012), Biochemistry 51: 3508-3522
RNA_NN3 = {
    'init': (6.40, 6.99), 'init_A/T': (3.85, 11.04), 'init_G/C': (0, 0),
    'init_oneG/C': (0, 0), 'init_allA/T': (0, 0), 'init_5T/A': (0, 0),
    'sym': (0, -1.4),
    'AA/TT': (-7.09, -19.8), 'AT/TA': (-9.11, -25.8), 'TA/AT': (-8.50, -22.9),
    'CA/GT': (-11.03, -28.8), 'GT/CA': (-11.98, -31.3),
    'CT/GA': (-10.90, -28.5), 'GA/CT': (-13.21, -34.9),
    'CG/GC': (-10.88, -27.4), 'GC/CG': (-16.04, -40.6),
    'GG/CC': (-14.18, -35.0), 'GT/TG': (-13.83, -46.9),
    'GG/TT': (-17.82, -56.7), 'AG/TT': (-3.96, -11.6),
    'TG/AT': (-0.96, -1.8), 'TT/AG': (-10.38, -31.8), 'TG/GT': (-12.64, -38.9),
    'AT/TG': (-7.39, -21.0), 'CG/GT': (-5.56, -13.9), 'CT/GG': (-9.44, -24.7),
    'GG/CT': (-7.03, -16.8), 'GT/CG': (-11.09, -28.8)}

# RNA/DNA
# Sugimoto et al. (1995), Biochemistry 34: 11211-11216
R_DNA_NN1 = {
    'init': (1.9, -3.9), 'init_A/T': (0, 0), 'init_G/C': (0, 0),
    'init_oneG/C': (0, 0), 'init_allA/T': (0, 0), 'init_5T/A': (0, 0),
    'sym': (0, 0),
    'AA/TT': (-11.5, -36.4), 'AC/TG': (-7.8, -21.6), 'AG/TC': (-7.0, -19.7),
    'AT/TA': (-8.3, -23.9), 'CA/GT': (-10.4, -28.4), 'CC/GG': (-12.8, -31.9),
    'CG/GC': (-16.3, -47.1), 'CT/GA': (-9.1, -23.5), 'GA/CT': (-8.6, -22.9),
    'GC/CG': (-8.0, -17.1), 'GG/CC': (-9.3, -23.2), 'GT/CA': (-5.9, -12.3),
    'TA/AT': (-7.8, -23.2), 'TC/AG': (-5.5, -13.5), 'TG/AC': (-9.0, -26.1),
    'TT/AA': (-7.8, -21.9)}

# Internal mismatch and inosine table (DNA)
# Allawi & SantaLucia (1997), Biochemistry 36: 10581-10594
# Allawi & SantaLucia (1998), Biochemistry 37: 9435-9444
# Allawi & SantaLucia (1998), Biochemistry 37: 2170-2179
# Allawi & SantaLucia (1998), Nucl Acids Res 26: 2694-2701
# Peyret et al. (1999), Biochemistry 38: 3468-3477
# Watkins & SantaLucia (2005), Nucl Acids Res 33: 6258-6267
DNA_IMM1 = {
    'AG/TT': (1.0, 0.9), 'AT/TG': (-2.5, -8.3), 'CG/GT': (-4.1, -11.7),
    'CT/GG': (-2.8, -8.0), 'GG/CT': (3.3, 10.4), 'GG/TT': (5.8, 16.3),
    'GT/CG': (-4.4, -12.3), 'GT/TG': (4.1, 9.5), 'TG/AT': (-0.1, -1.7),
    'TG/GT': (-1.4, -6.2), 'TT/AG': (-1.3, -5.3), 'AA/TG': (-0.6, -2.3),
    'AG/TA': (-0.7, -2.3), 'CA/GG': (-0.7, -2.3), 'CG/GA': (-4.0, -13.2),
    'GA/CG': (-0.6, -1.0), 'GG/CA': (0.5, 3.2), 'TA/AG': (0.7, 0.7),
    'TG/AA': (3.0, 7.4),
    'AC/TT': (0.7, 0.2), 'AT/TC': (-1.2, -6.2), 'CC/GT': (-0.8, -4.5),
    'CT/GC': (-1.5, -6.1), 'GC/CT': (2.3, 5.4), 'GT/CC': (5.2, 13.5),
    'TC/AT': (1.2, 0.7), 'TT/AC': (1.0, 0.7),
    'AA/TC': (2.3, 4.6), 'AC/TA': (5.3, 14.6), 'CA/GC': (1.9, 3.7),
    'CC/GA': (0.6, -0.6), 'GA/CC': (5.2, 14.2), 'GC/CA': (-0.7, -3.8),
    'TA/AC': (3.4, 8.0), 'TC/AA': (7.6, 20.2),
    'AA/TA': (1.2, 1.7), 'CA/GA': (-0.9, -4.2), 'GA/CA': (-2.9, -9.8),
    'TA/AA': (4.7, 12.9), 'AC/TC': (0.0, -4.4), 'CC/GC': (-1.5, -7.2),
    'GC/CC': (3.6, 8.9), 'TC/AC': (6.1, 16.4), 'AG/TG': (-3.1, -9.5),
    'CG/GG': (-4.9, -15.3), 'GG/CG': (-6.0, -15.8), 'TG/AG': (1.6, 3.6),
    'AT/TT': (-2.7, -10.8), 'CT/GT': (-5.0, -15.8), 'GT/CT': (-2.2, -8.4),
    'TT/AT': (0.2, -1.5),
    'AI/TC': (-8.9, -25.5), 'TI/AC': (-5.9, -17.4), 'AC/TI': (-8.8, -25.4),
    'TC/AI': (-4.9, -13.9), 'CI/GC': (-5.4, -13.7), 'GI/CC': (-6.8, -19.1),
    'CC/GI': (-8.3, -23.8), 'GC/CI': (-5.0, -12.6),
    'AI/TA': (-8.3, -25.0), 'TI/AA': (-3.4, -11.2), 'AA/TI': (-0.7, -2.6),
    'TA/AI': (-1.3, -4.6), 'CI/GA': (2.6, 8.9), 'GI/CA': (-7.8, -21.1),
    'CA/GI': (-7.0, -20.0), 'GA/CI': (-7.6, -20.2),
    'AI/TT': (0.49, -0.7), 'TI/AT': (-6.5, -22.0), 'AT/TI': (-5.6, -18.7),
    'TT/AI': (-0.8, -4.3), 'CI/GT': (-1.0, -2.4), 'GI/CT': (-3.5, -10.6),
    'CT/GI': (0.1, -1.0), 'GT/CI': (-4.3, -12.1),
    'AI/TG': (-4.9, -15.8), 'TI/AG': (-1.9, -8.5), 'AG/TI': (0.1, -1.8),
    'TG/AI': (1.0, 1.0), 'CI/GG': (7.1, 21.3), 'GI/CG': (-1.1, -3.2),
    'CG/GI': (5.8, 16.9), 'GG/CI': (-7.6, -22.0),
    'AI/TI': (-3.3, -11.9), 'TI/AI': (0.1, -2.3), 'CI/GI': (1.3, 3.0),
    'GI/CI': (-0.5, -1.3)}

# Terminal mismatch table (DNA)
# SantaLucia & Peyret (2001) Patent Application WO 01/94611
DNA_TMM1 = {
    'AA/TA': (-3.1, -7.8), 'TA/AA': (-2.5, -6.3), 'CA/GA': (-4.3, -10.7),
    'GA/CA': (-8.0, -22.5),
    'AC/TC': (-0.1, 0.5), 'TC/AC': (-0.7, -1.3), ' CC/GC': (-2.1, -5.1),
    'GC/CC': (-3.9, -10.6),
    'AG/TG': (-1.1, -2.1), 'TG/AG': (-1.1, -2.7), 'CG/GG': (-3.8, -9.5),
    'GG/CG': (-0.7, -19.2),
    'AT/TT': (-2.4, -6.5), 'TT/AT': (-3.2, -8.9), 'CT/GT': (-6.1, -16.9),
    'GT/CT': (-7.4, -21.2),
    'AA/TC': (-1.6, -4.0), 'AC/TA': (-1.8, -3.8), 'CA/GC': (-2.6, -5.9),
    'CC/GA': (-2.7, -6.0), 'GA/CC': (-5.0, -13.8), 'GC/CA': (-3.2, -7.1),
    'TA/AC': (-2.3, -5.9), 'TC/AA': (-2.7, -7.0),
    'AC/TT': (-0.9, -1.7), 'AT/TC': (-2.3, -6.3), 'CC/GT': (-3.2, -8.0),
    'CT/GC': (-3.9, -10.6), 'GC/CT': (-4.9, -13.5), 'GT/CC': (-3.0, -7.8),
    'TC/AT': (-2.5, -6.3), 'TT/AC': (-0.7, -1.2),
    'AA/TG': (-1.9, -4.4), 'AG/TA': (-2.5, -5.9), 'CA/GG': (-3.9, -9.6),
    'CG/GA': (-6.0, -15.5), 'GA/CG': (-4.3, -11.1), ' GG/CA': (-4.6, -11.4),
    'TA/AG': (-2.0, -4.7), 'TG/AA': (-2.4, -5.8),
    'AG/TT': (-3.2, -8.7), 'AT/TG': (-3.5, -9.4), 'CG/GT': (-3.8, -9.0),
    'CT/GG': (-6.6, -18.7), 'GG/CT': (-5.7, -15.9), 'GT/CG': (-5.9, -16.1),
    'TG/AT': (-3.9, -10.5), 'TT/AG': (-3.6, -9.8)}

# Dangling ends table (DNA)
# Bommarito et al. (2000), Nucl Acids Res 28: 1929-1934
DNA_DE1 = {
    'AA/.T': (0.2, 2.3), 'AC/.G': (-6.3, -17.1), 'AG/.C': (-3.7, -10.0),
    'AT/.A': (-2.9, -7.6), 'CA/.T': (0.6, 3.3), 'CC/.G': (-4.4, -12.6),
    'CG/.C': (-4.0, -11.9), 'CT/.A': (-4.1, -13.0), 'GA/.T': (-1.1, -1.6),
    'GC/.G': (-5.1, -14.0), 'GG/.C': (-3.9, -10.9), 'GT/.A': (-4.2, -15.0),
    'TA/.T': (-6.9, -20.0), 'TC/.G': (-4.0, -10.9), 'TG/.C': (-4.9, -13.8),
    'TT/.A': (-0.2, -0.5),
    '.A/AT': (-0.7, -0.8), '.C/AG': (-2.1, -3.9), '.G/AC': (-5.9, -16.5),
    '.T/AA': (-0.5, -1.1), '.A/CT': (4.4, 14.9), '.C/CG': (-0.2, -0.1),
    '.G/CC': (-2.6, -7.4), '.T/CA': (4.7, 14.2), '.A/GT': (-1.6, -3.6),
    '.C/GG': (-3.9, -11.2), '.G/GC': (-3.2, -10.4), '.T/GA': (-4.1, -13.1),
    '.A/TT': (2.9, 10.4), '.C/TG': (-4.4, -13.1), '.G/TC': (-5.2, -15.0),
    '.T/TA': (-3.8, -12.6)}

# Dangling ends table (RNA)
# Turner & Mathews (2010), Nucl Acids Res 38: D280-D282
RNA_DE1 = {
    '.T/AA': (-4.9, -13.2), '.T/CA': (-0.9, -1.3), '.T/GA': (-5.5, -15.1),
    '.T/TA': (-2.3, -5.5),
    '.G/AC': (-9.0, -23.5), '.G/CC': (-4.1, -10.6), '.G/GC': (-8.6, -22.2),
    '.G/TC': (-7.5, -20.31),
    '.C/AG': (-7.4, -20.3), '.C/CG': (-2.8, -7.7), '.C/GG': (-6.4, -16.4),
    '.C/TG': (-3.6, -9.7),
    '.T/AG': (-4.9, -13.2), '.T/CG': (-0.9, -1.3), '.T/GG': (-5.5, -15.1),
    '.T/TG': (-2.3, -5.5),
    '.A/AT': (-5.7, -16.1), '.A/CT': (-0.7, -1.9), '.A/GT': (-5.8, -16.4),
    '.A/TT': (-2.2, -6.8),
    '.G/AT': (-5.7, -16.1), '.G/CT': (-0.7, -1.9), '.G/GT': (-5.8, -16.4),
    '.G/TT': (-2.2, -6.8),
    'AT/.A': (-0.5, -0.6), 'CT/.A': (6.9, 22.6), 'GT/.A': (0.6, 2.6),
    'TT/.A': (0.6, 2.6),
    'AG/.C': (-1.6, -4.5), 'CG/.C': (0.7, 3.2), 'GG/.C': (-4.6, -14.8),
    'TG/.C': (-0.4, -1.3),
    'AC/.G': (-2.4, -6.1), 'CC/.G': (3.3, 11.6), 'GC/.G': (0.8, 3.2),
    'TC/.G': (-1.4, -4.2),
    'AT/.G': (-0.5, -0.6), 'CT/.G': (6.9, 22.6), 'GT/.G': (0.6, 2.6),
    'TT/.G': (0.6, 2.6),
    'AA/.T': (1.6, 6.1), 'CA/.T': (2.2, 8.1), 'GA/.T': (0.7, 3.5),
    'TA/.T': (3.1, 10.6),
    'AG/.T': (1.6, 6.1), 'CG/.T': (2.2, 8.1), 'GG/.T': (0.7, 3.5),
    'TG/.T': (3.1, 10.6)}

_CNV = lambda x: {i: np.array(j, dtype = 'f8') for i, j in x.items()}
def _create_data(locs) -> Dict[str, NNDATA]:
    data: Dict[str, NNDATA] = {}
    for i, j in list(locs.items()):
        if any(i.startswith(j+"_") for j in ("DNA", "RNA", "LNA", "R_DNA")):
            data[i] = locs[i] = _CNV(j)
    return data

DATA = _create_data(locals())
del _create_data

def nndata(name, *others) -> NNDATA:
    "return the data associated to a name"
    get = lambda key: DATA[key] if isinstance(key, str) else _CNV(dict(key))

    out: NNDATA = {}
    for key in others[::-1]+(name,):
        out.update(get(key))
    return out

R  = 1.9872  # universal gas constant in Cal/degrees C*Mol
T0 = 273.15
